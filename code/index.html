<!DOCTYPE html>
<!-- Hallo! -->
<html>
	<head>

		<meta charset="UTF-8">
		<title>Neural Networks - Project</title>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
		<script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
		<script>
			var map = null;
			var mapinfo;
						
			function getMap() {
				map = new Microsoft.Maps.Map(document.getElementById('map_id'), 
				{
					credentials: 'AkrBJqwqx23-hEkqsxaxgZFRniylWYEI9pSSfcQz8NZQB0lToABb3ky5lra_rllS',
					width: 816, height: 528,
					enableClickableLogo: false,
					enableSearchLogo: false,
					showDashboard: false,
					showMapTypeSelector:false,
					disableZooming: true,
					showScalebar: false,
					disablePanning: true,
					// 100m zoom
					zoom: 16, 
					mapTypeId: Microsoft.Maps.MapTypeId.aerial,
					center: new Microsoft.Maps.Location(52.298379183128596, 4.942471264136956),
					labelOverlay: Microsoft.Maps.LabelOverlay.hidden
				});
			}

			function clickRandom() {
				// Manually found bounding box locations
				var minLat = 52.298379183128596;
				var maxLat = 52.43520441347777;
				var minLong = 4.764510040406664;
				var maxLong = 4.942471264136956;

				var randomLat = Math.random() * (maxLat - minLat) + minLat;
				var randomLong = Math.random() * (maxLong - minLong) + minLong;
				
				map.setView({ zoom: 16, center: new Microsoft.Maps.Location(randomLat, randomLong) })
				console.log(randomLat + ", " + randomLong);

				map.getCredentials(makeLocationRequest);
			}

			function clickGetImage(credentials) {
				map.getCredentials(makeImageRequest);
			}

			function makeImageRequest(credentials) {
				var lat = map.getCenter().latitude;
				var lon = map.getCenter().longitude;
				var link = "http://dev.virtualearth.net/REST/v1/Imagery/Map/Aerial/"+lat+","+lon+"/16?mapSize=816,528&key=" + credentials;
				console.log(link);
			}

			function clickLocationInfo(credentials) {
				map.getCredentials(makeLocationRequest);
			}

			function makeLocationRequest(credentials) {
				var lat = map.getCenter().latitude;
				var lon = map.getCenter().longitude;
				var link = "http://dev.virtualearth.net/REST/v1/Locations/"+lat+","+lon+"?o=json&key=" + credentials;
				callRestService(link, locationCallback);
			}

			function callRestService(request, callback) {
			    $.ajax({
			        url: request,
			        dataType: "jsonp",
			        jsonp: "jsonp",
			        success: function (r) {
			            callback(r);
			        },
			        error: function (e) {
			            alert(e.statusText);
			        }
			    });
			}

			function locationCallback(result) {
				$("#location_name").text("Location: " + result.resourceSets[0].resources[0].name);
			}

			// Establish connection to node server
			var socket = io.connect('http://localhost:8080');

			// Emit event flag to node server
			socket.emit('event');

			// Perform action upon receiving reply flag
			socket.on('reply', function (data) {
				console.log("Received from Node.js: " + data);
			});

		</script>
	
		<style>
			#container {
				position: absolute;
				margin-left: 80px;
				margin-top:80px;
				width : 1200px;
				height : 500px;
				float: left;
				z-index: 1;
			}
			#map_id {
				width : 816px;
				height : 528px;
				z-index:2;
			}
			#map-hiders {
				position: absolute;
				margin-left: -50px;
				margin-top:-500px;
				z-index: 3;
			}
			#interaction {
				float: left;
				width: 800px;
			}
			#gmapscontrolremover-bottom {
				position: absolute;
				margin-left: 50px;
				margin-top:475px;
				width:816px;
				height:25px;
				background-color: white;
				z-index:4;
			}
			#header {
				position: absolute;
				margin-left: 80px;
				margin-top: 30px;
				height:50px;
				z-index: 5;
			}
			.title {
				font-size: 25px;
			}
			.control-title {
				margin-left:10px;
				margin-top:10px;
				font-size: 18px;
			}
			.control {
				margin-left:10px;
				margin-top:10px;
			}
			.control-legend {
				width: 30px;
				font-size: 14px;
				float: left;
			}
			.control-slider {
				margin-left:10px;
			}
			#randombutton {
				text-align: center;
			}
			#getimagebutton {
				text-align: center;
			}
			#getlocationinfo {
				text-align: center;
			}
			#classifybutton {
				text-align: center;
			}
		</style>

	</head>

	<body onload="getMap();">
		<div id="header" class="title">Random Satellite View</div>
		<div id="container">
			<div id="map_id"></div>
			<div id="map-hiders">
				<div id="gmapscontrolremover-bottom"></div>
			</div>
			<div id="location_name">Location: </div>
			<div id="interaction">
				<div id="randombutton">
					<button type="button" onclick="clickRandom()">new image</button>
				</div>
				<div id="getimagebutton">
					<button type="button" onclick="clickGetImage()">get image link</button>
				</div>
				<div id="getlocationinfo">
					<button type="button" onclick="clickLocationInfo()">get location info</button>
				</div>
			</div>
		</div>
	</body>

</html>